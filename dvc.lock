schema: '2.0'
stages:
  download:
    cmd: python3 main.py --download-data
    deps:
    - path: src/data/download.py
      hash: md5
      md5: a597d17b805e722547ee6e9a410dde94
      size: 1165
    outs:
    - path: pipeline_output/data/raw/uniref50.fasta.gz
      hash: md5
      md5: b39e4fdf12810e78e2befdf7460f255b
      size: 92924866
  extract:
    cmd: python3 main.py --extract-data
    deps:
    - path: pipeline_output/data/raw/uniref50.fasta.gz
      hash: md5
      md5: b39e4fdf12810e78e2befdf7460f255b
      size: 92924866
    - path: src/data/extract.py
      hash: md5
      md5: 11f0abad53909c4cd01bd7bac805ef70
      size: 1133
    outs:
    - path: pipeline_output/data/raw/uniref50.fasta
      hash: md5
      md5: acd7214694350f9a0c097122b777c978
      size: 286365155
  preprocess:
    cmd: python3 main.py --preprocess-data
    deps:
    - path: pipeline_output/data/raw/uniref50.fasta
      hash: md5
      md5: acd7214694350f9a0c097122b777c978
      size: 286365155
    - path: src/data/preprocess.py
      hash: md5
      md5: 69e0e61bee2114bbe3a0b837c636499a
      size: 6703
    params:
      src/data/params.yaml:
        max_seqs_number: 202
        max_sequence_length: 512
        min_sequence_length: 20
    outs:
    - path: pipeline_output/data/processed/uniref50_processed.fasta
      hash: md5
      md5: 7099fbb631785692da131ae0a98ed059
      size: 60788
  split:
    cmd: python3 main.py --split-data
    deps:
    - path: pipeline_output/data/processed/uniref50_processed.fasta
      hash: md5
      md5: 71acc0b1a97c9c5f35cf2e156da32c9b
      size: 36604
    - path: src/data/preprocess.py
      hash: md5
      md5: 1e52c9c8336dae36ad05ea93ba18cafd
      size: 11336
    params:
      src/data/params.yaml:
        val_ratio: 0.1
    outs:
    - path: pipeline_output/data/processed/dataset_info.txt
      hash: md5
      md5: cf8deef511f4fb00d60deb710394caeb
      size: 327
    - path: pipeline_output/data/processed/train.fasta
      hash: md5
      md5: 7e815426014e03685b43ef633b7e045e
      size: 33381
    - path: pipeline_output/data/processed/val.fasta
      hash: md5
      md5: 32e0be3def6ae5c6176ce1ed7f2cff89
      size: 3223
  tokenize:
    cmd: python3 main.py --tokenize-data
    deps:
    - path: pipeline_output/data/processed/train.fasta
      hash: md5
      md5: 7e815426014e03685b43ef633b7e045e
      size: 33381
    - path: pipeline_output/data/processed/val.fasta
      hash: md5
      md5: 32e0be3def6ae5c6176ce1ed7f2cff89
      size: 3223
    - path: src/data/preprocess.py
      hash: md5
      md5: 1e52c9c8336dae36ad05ea93ba18cafd
      size: 11336
    params:
      src/data/params.yaml:
        batch_size: 32
    outs:
    - path: pipeline_output/data/processed/train_tokenized
      hash: md5
      md5: 686b203843b0da1c1b38b9b6076fd21e.dir
      size: 860004
      nfiles: 5
    - path: pipeline_output/data/processed/val_tokenized
      hash: md5
      md5: 4c7fabf6bc76ddc768ed0917fa582a40.dir
      size: 65940
      nfiles: 2
  filter:
    cmd: python3 main.py --filter-data
    deps:
    - path: pipeline_output/data/raw/uniref50.fasta
      hash: md5
      md5: acd7214694350f9a0c097122b777c978
      size: 286365155
    - path: src/data/preprocess.py
      hash: md5
      md5: 1e52c9c8336dae36ad05ea93ba18cafd
      size: 11336
    params:
      src/data/params.yaml:
        max_seqs_number: 120
        max_sequence_length: 512
        min_sequence_length: 20
    outs:
    - path: pipeline_output/data/processed/uniref50_processed.fasta
      hash: md5
      md5: 71acc0b1a97c9c5f35cf2e156da32c9b
      size: 36604
  teacher_embeddings:
    cmd: python3 main.py --generate-teacher-embeddings
    deps:
    - path: pipeline_output/data/processed/train_tokenized
      hash: md5
      md5: 686b203843b0da1c1b38b9b6076fd21e.dir
      size: 860004
      nfiles: 5
    - path: pipeline_output/data/processed/val_tokenized
      hash: md5
      md5: 4c7fabf6bc76ddc768ed0917fa582a40.dir
      size: 65940
      nfiles: 2
    - path: src/distillation/teacher_embed.py
      hash: md5
      md5: 30690ce310fe6530d55774a60379efef
      size: 5729
    - path: src/models/teacher.py
      hash: md5
      md5: 546775457601f1cfc439577e0c546ca4
      size: 6008
    params:
      src/data/params.yaml:
        batch_size: 32
    outs:
    - path: pipeline_output/data/processed/teacher_embeddings
      hash: md5
      md5: b756dfc04fdf6eddbf20beeb73939898.dir
      size: 222358584
      nfiles: 7
